# 数字签名 ECDSA

数字签名是一种用于验证数据完整性和真实性的技术。它类似于手写签名或印章，但更加安全和可靠。数字签名主要有两个功能：

1. **验证数据完整性**：确保数据在传输过程中没有被篡改。
2. **验证数据真实性**：确保数据确实来自声称的发送者。

## ECDSA 的基本原理

ECDSA 是一种基于椭圆曲线密码学的数字签名算法。它使用椭圆曲线上的点进行数学运算，具有高效和安全的特点。ECDSA 的基本步骤如下：

1. **密钥生成**：生成一对密钥，包括私钥和公钥。
2. **签名生成**：使用私钥对数据进行签名，生成数字签名。
3. **签名验证**：使用公钥验证数字签名，确保数据的完整性和真实性。

### 1. 密钥生成

密钥生成是 ECDSA 的第一步。它生成一对密钥，包括私钥和公钥。私钥用于签名数据，公钥用于验证签名。

- **私钥**：一个随机生成的大整数。
- **公钥**：通过椭圆曲线上的点乘运算从私钥生成。

### 2. 签名生成

签名生成是 ECDSA 的第二步。它使用私钥对数据进行签名，生成数字签名。签名生成的步骤如下：

1. 计算数据的哈希值。
2. 生成一个随机数 `k`。
3. 计算椭圆曲线上的点 `(x1, y1)`，其中 `x1 = k * G`，`G` 是椭圆曲线的基点。
4. 计算签名的两个部分 `r` 和 `s`：
   - `r = x1 mod n`，其中 `n` 是椭圆曲线的阶。
   - `s = (hash + r * privateKey) * k^(-1) mod n`，其中 `k^(-1)` 是 `k` 的模逆。

签名 `(r, s)` 就是数据的数字签名。

### 3. 签名验证

签名验证是 ECDSA 的第三步。它使用公钥验证数字签名，确保数据的完整性和真实性。签名验证的步骤如下：

1. 计算数据的哈希值。
2. 计算两个椭圆曲线上的点 `(x1, y1)` 和 `(x2, y2)`：
   - `x1 = (hash * s^(-1) mod n) * G`，其中 `s^(-1)` 是 `s` 的模逆。
   - `x2 = (r * s^(-1) mod n) * publicKey`。
3. 计算点 `(x, y)`，其中 `(x, y) = x1 + x2`。
4. 验证 `r` 是否等于 `x mod n`。

如果 `r` 等于 `x mod n`，则签名有效，数据的完整性和真实性得到验证。

## 示例

```sh
npx ts-node .\src\ecdsa.ts
```
