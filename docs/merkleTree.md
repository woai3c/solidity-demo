# Merkle Tree

Merkle Tree（默克尔树）是一种数据结构，广泛应用于区块链和分布式系统中，用于高效和安全地验证数据的完整性和一致性。它是一种二叉树，其中每个叶子节点包含数据块的哈希值，而每个非叶子节点包含其子节点哈希值的哈希值。最终，树的根节点（称为 Merkle 根）代表整个数据集的哈希值。

## Merkle Tree 的结构

Merkle Tree 的基本结构如下：

1. 叶子节点：每个叶子节点包含一个数据块的哈希值。
1. 非叶子节点：每个非叶子节点包含其两个子节点哈希值的哈希值。
1. 根节点：树的根节点包含整个数据集的哈希值，称为 Merkle 根。

## Merkle Tree 的构建过程

1. 计算叶子节点的哈希值：对每个数据块计算哈希值，作为叶子节点。
1. 构建非叶子节点：将相邻的两个叶子节点的哈希值进行哈希运算，得到其父节点的哈希值。
1. 重复步骤 2：对所有非叶子节点重复上述过程，直到只剩下一个根节点。

## Merkle Tree 的优点

1. 高效验证：通过 Merkle 树，可以高效地验证某个数据块是否属于数据集，只需验证从该数据块到根节点的路径上的哈希值。
1. 数据完整性：Merkle 树可以确保数据的完整性和一致性，任何数据块的改变都会导致根节点的哈希值发生变化。
1. 节省带宽：在分布式系统中，只需传输少量的哈希值即可验证数据的完整性，而不需要传输整个数据集。

## Merkle Tree 的验证原理

验证某个数据块是否属于 Merkle 树的过程称为“证明路径验证”。证明路径是从叶子节点到根节点的一系列哈希值，用于验证某个叶子节点是否属于 Merkle 树。通过证明路径，可以高效地验证数据的完整性和一致性，而无需访问整个数据集。

## 验证步骤

1. 计算叶子节点的哈希值：首先计算要验证的叶子节点的哈希值。
1. 逐层验证哈希值：从叶子节点开始，逐层将当前节点的哈希值与证明路径中的哈希值进行拼接并计算哈希值，直到达到根节点。
1. 比较根节点的哈希值：将计算得到的根节点哈希值与实际的根节点哈希值进行比较。如果两者相同，则证明该叶子节点的数据是有效的，并且在这棵 Merkle 树中。

## 示例

```sh
npx ts-node .\src\MerkleTree.ts
```
